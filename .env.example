# ============================================
# MCP Server for New Relic - Environment Configuration
# ============================================
# Copy this file to .env and update with your values

# ============================================
# New Relic API Configuration (REQUIRED)
# ============================================
# Your New Relic User API Key (for GraphQL/NRDB queries)
NEW_RELIC_API_KEY=your-user-api-key-here

# Your New Relic Account ID
NEW_RELIC_ACCOUNT_ID=your-account-id-here

# New Relic Region (US or EU)
NEW_RELIC_REGION=US

# New Relic GraphQL Endpoint (auto-configured based on region)
# NEW_RELIC_GRAPHQL_ENDPOINT=https://api.newrelic.com/graphql

# ============================================
# New Relic APM Configuration (REQUIRED for monitoring)
# ============================================
# Your New Relic License Key (for APM instrumentation)
NEW_RELIC_LICENSE_KEY=your-license-key-here

# APM Application Name
NEW_RELIC_APP_NAME=mcp-server-newrelic

# APM Environment
NEW_RELIC_ENVIRONMENT=development

# Enable distributed tracing
NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true

# APM Log Level (debug, info, warn, error)
NEW_RELIC_LOG_LEVEL=info

# Python APM specific
NEW_RELIC_CONFIG_FILE=newrelic.ini
NEW_RELIC_MONITOR_MODE=true
NEW_RELIC_HIGH_SECURITY=false

# Go APM specific
NEW_RELIC_ATTRIBUTES_INCLUDE=request.headers.*
NEW_RELIC_ATTRIBUTES_EXCLUDE=request.headers.authorization

# ============================================
# OpenTelemetry Configuration (Optional)
# ============================================
OTEL_SERVICE_NAME=mcp-server-newrelic
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_EXPORTER_OTLP_PROTOCOL=grpc
OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp
OTEL_LOGS_EXPORTER=otlp

# ============================================
# Service Configuration
# ============================================
# Server Configuration
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
MCP_TRANSPORT=stdio  # stdio, http, or sse
MCP_HTTP_PORT=8081
MCP_SSE_PORT=8082

# Logging
LOG_LEVEL=INFO  # DEBUG, INFO, WARN, ERROR
LOG_FORMAT=json  # json or text
LOG_OUTPUT=stdout  # stdout, stderr, or file path

# ============================================
# Component-Specific Configuration
# ============================================
# Discovery Engine
DISCOVERY_CACHE_TTL=3600  # seconds
DISCOVERY_MAX_WORKERS=10
DISCOVERY_SAMPLE_SIZE=1000
DISCOVERY_PATTERN_MIN_CONFIDENCE=0.7

# Intelligence Engine
INTELLIGENCE_GRPC_HOST=intelligence-engine
INTELLIGENCE_GRPC_PORT=50051
INTELLIGENCE_LOG_LEVEL=INFO
INTELLIGENCE_ENABLE_METRICS=true
INTELLIGENCE_METRICS_PORT=8080
INTELLIGENCE_PATTERN_MIN_CONFIDENCE=0.7
INTELLIGENCE_QUERY_CACHE_SIZE=100
INTELLIGENCE_QUERY_OPTIMIZER_MODE=balanced

# MCP Configuration
MCP_ENABLED=true
MCP_REQUEST_TIMEOUT=30s
MCP_MAX_MESSAGE_SIZE=10485760  # 10MB
MCP_STREAM_BUFFER_SIZE=1000

# API Configuration
API_ENABLED=true
API_PREFIX=/api/v1
SWAGGER_ENABLED=true
CORS_ENABLED=true
CORS_ALLOWED_ORIGINS=*

# ============================================
# Data Storage & Caching
# ============================================
# State Management Configuration
STATE_STORE_TYPE=memory  # memory or redis
SESSION_TTL=1h  # Session expiration time
CACHE_TTL=5m  # Default cache TTL
MAX_SESSIONS=10000  # Maximum concurrent sessions (memory store)
MAX_CACHE_ENTRIES=100000  # Maximum cache entries (memory store)
MAX_CACHE_MEMORY=1073741824  # Maximum cache memory in bytes (1GB)

# Redis Configuration (required if STATE_STORE_TYPE=redis)
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_POOL_SIZE=10
REDIS_MAX_RETRIES=3
REDIS_TIMEOUT=5s
REDIS_KEY_PREFIX=uds  # Prefix for all Redis keys

# Cache Configuration
CACHE_ENABLED=true
CACHE_DEFAULT_TTL=300  # seconds
CACHE_MAX_SIZE=1000
CACHE_EVICTION_POLICY=lru

# ============================================
# Security Configuration
# ============================================
# Authentication
AUTH_ENABLED=false
JWT_SECRET=your-jwt-secret-here-change-in-production
JWT_EXPIRY=24h
API_KEY_SALT=your-api-key-salt-here-change-in-production

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MIN=60
RATE_LIMIT_BURST=10

# TLS/SSL
TLS_ENABLED=false
TLS_CERT_FILE=/path/to/cert.pem
TLS_KEY_FILE=/path/to/key.pem

# ============================================
# Performance & Resource Limits
# ============================================
# Concurrency
MAX_CONCURRENT_REQUESTS=100
MAX_CONCURRENT_DISCOVERIES=10
WORKER_POOL_SIZE=20

# Timeouts
REQUEST_TIMEOUT=30s
QUERY_TIMEOUT=25s
DISCOVERY_TIMEOUT=60s

# Memory Limits
MAX_MEMORY_MB=2048
GC_PERCENT=100

# ============================================
# Monitoring & Observability
# ============================================
# Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health Checks
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=5s

# Distributed Tracing
TRACING_ENABLED=true
TRACING_SAMPLE_RATE=1.0
JAEGER_AGENT_HOST=localhost
JAEGER_AGENT_PORT=6831

# ============================================
# Feature Flags
# ============================================
ENABLE_PATTERN_DETECTION=true
ENABLE_QUERY_GENERATION=true
ENABLE_VISUALIZATION_RECOMMENDATIONS=true
ENABLE_ANOMALY_DETECTION=true
ENABLE_RELATIONSHIP_MINING=true
ENABLE_QUALITY_ASSESSMENT=true
ENABLE_INTELLIGENT_SAMPLING=true
ENABLE_A2A_PROTOCOL=false
ENABLE_EXPERIMENTAL_FEATURES=false

# ============================================
# Development & Debug
# ============================================
# Development Mode
DEV_MODE=false
DEBUG=false
VERBOSE_LOGGING=false

# Profiling
ENABLE_PROFILING=false
PPROF_PORT=6060

# Mock Mode (for testing without New Relic account)
MOCK_MODE=false
MOCK_DATA_FILE=/path/to/mock-data.json

# ============================================
# Docker & Container Configuration
# ============================================
# Container Registry
DOCKER_REGISTRY=docker.io
DOCKER_NAMESPACE=mcp-server-newrelic

# Resource Limits (for docker-compose)
CONTAINER_CPU_LIMIT=2
CONTAINER_MEMORY_LIMIT=2G

# ============================================
# External Service URLs
# ============================================
# Grafana
GRAFANA_URL=http://localhost:3000
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin

# Prometheus
PROMETHEUS_URL=http://localhost:9090
PROMETHEUS_RETENTION_DAYS=15

# ============================================
# Deployment Configuration
# ============================================
# Environment
ENVIRONMENT=development  # development, staging, production
DEPLOYMENT_ID=local
REGION=us-east-1
AVAILABILITY_ZONE=us-east-1a